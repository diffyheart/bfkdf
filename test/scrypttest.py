#!/usr/bin/python

import collections
import random
import sys

sys.path.append('../main')

import scrypt

expected  = b'\x77\xd6\x57\x62\x38\x65\x7b\x20\x3b\x19\xca\x42\xc1\x8a\x04\x97'
expected += b'\xf1\x6b\x48\x44\xe3\x07\x4a\xe8\xdf\xdf\xfa\x3f\xed\xe2\x14\x42'
expected += b'\xfc\xd0\x06\x9d\xed\x09\x48\xf8\x32\x6a\x75\x3a\x0f\xc8\x1f\x17'
expected += b'\xe8\xd3\xe0\xfb\x2e\x0d\x36\x28\xcf\x35\xe2\x0c\x38\xd1\x89\x06'
actual = scrypt.hash(b'', b'', 16, 1, 1, 64)
assert actual == expected, "scrypt.hash(b'', b'', 16, 1, 1, 64) failed"

expected  = b'\xfd\xba\xbe\x1c\x9d\x34\x72\x00\x78\x56\xe7\x19\x0d\x01\xe9\xfe'
expected += b'\x7c\x6a\xd7\xcb\xc8\x23\x78\x30\xe7\x73\x76\x63\x4b\x37\x31\x62'
expected += b'\x2e\xaf\x30\xd9\x2e\x22\xa3\x88\x6f\xf1\x09\x27\x9d\x98\x30\xda'
expected += b'\xc7\x27\xaf\xb9\x4a\x83\xee\x6d\x83\x60\xcb\xdf\xa2\xcc\x06\x40'
actual = scrypt.hash(b'password', b'NaCl', 1024, 8, 16, 64)
assert actual == expected, "scrypt.hash(b'password', b'NaCl', 1024, 8, 16, 64)"

